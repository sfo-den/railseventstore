---
title: Minitest assertions
---

## Installation

## Event assertions

### assert_dispatched(event_store, expected_events, &block)
Verifies that an event or events of certain type were published to the event store during the execution of the block.

Example usage:
```ruby
assert_dispatched(@event_store, DummyEvent) { @event_store.publish(DummyEvent.new) }

assert_dispatched(@event_store, [DummyEvent]) { @event_store.publish(DummyEvent.new) }
```

### assert_not_dispatched(event_store, expected_events, &block)
Verifies that an event or events of certain type were not published to the event store during the execution of the block.

```ruby
assert_not_dispatched(@event_store, [DummyEvent]) {}

assert_not_dispatched(@event_store, DummyEvent) {}
```

### assert_published(event_store, event_type, with_data: nil, with_metadata: nil, within_stream: nil, &block)
Verifies that an event of certain type was published to the event store.

```ruby
@event_store.publish(DummyEvent.new)
assert_published(@event_store, DummyEvent)

@event_store.publish(DummyEvent.new(data: { "foo" => "bar" }))
assert_published(@event_store, DummyEvent, with_data: { "foo" => "bar" })

@event_store.with_metadata(foo: "bar") { @event_store.publish(DummyEvent.new) }
assert_published(@event_store, DummyEvent, with_metadata: { "foo" => "bar" })
```

### assert_not_published(event_store, event_type, with_data: nil, with_metadata: nil, within_stream: nil, &block)
Verifies that an event of certain type was not published to the event store.

```ruby
@event_store.publish(DummyEvent.new)

assert_not_published(@event_store, AnotherDummyEvent)
```

### assert_published_once(event_store, event_type, with_data: nil, with_metadata: nil, within_stream: nil, &block)
Verifies that an event of certain type was published exactly once to the event store.

```ruby
@event_store.publish(DummyEvent.new)
@event_store.publish(AnotherDummyEvent.new)
assert_published_once(@event_store, DummyEvent)

assert_published_once(@event_store, DummyEvent) do
    @event_store.publish(DummyEvent.new)
end

@event_store.publish(DummyEvent.new(data: { "foo" => "bar" }))
assert_published_once(@event_store, DummyEvent, with_data: {foo: "bar"})

@event_store.with_metadata(foo: "bar") { @event_store.publish(DummyEvent.new) }
assert_published_once(@event_store, DummyEvent, with_metadata: { "foo" => "bar" })
```

### assert_nothing_published(event_store, &block)
Verifies that no events were published to the event store.
